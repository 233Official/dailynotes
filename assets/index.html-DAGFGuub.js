import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,a as i,o as p}from"./app-DX9gUdjC.js";const r={};function s(o,e){return p(),t("div",null,e[0]||(e[0]=[i('<h1 id="pdf-嵌入-javascript" tabindex="-1"><a class="header-anchor" href="#pdf-嵌入-javascript"><span>PDF 嵌入 JavaScript</span></a></h1><blockquote><p><a href="https://www.wanganke.com/web/article/show/2411" target="_blank" rel="noopener noreferrer">实战|通过恶意 pdf 执行 xss 漏洞 - 网安客 (wanganke.com)</a></p></blockquote><p>PDF 文件本身支持 JavaScript, 因此攻击者可以创建文件, 在文件打开时执行脚本来下载额外的恶意载荷或者窃取信息</p><p>下载并安装 <a href="https://www.xunjiepdf.com/editor" target="_blank" rel="noopener noreferrer">迅捷PDF编辑器 - 多功能的PDF编辑软件 (xunjiepdf.com)</a></p><p>新建或打开一个 PDF 文档</p><p>打开 <code>视图-&gt;页面缩略图</code></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060017522.png" alt="image-20240506001705447"></p><p>在左侧缩略图选中一个页面打开属性</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060019088.png" alt="image-20240506001933010"></p><p>在右侧页面属性栏中找到动作, 为 <code>打开页面</code> 或 <code>关闭页面</code> 添加一个动作, <code>新增-&gt;运行JavaScript</code></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060020732.png" alt="image-20240506002037634"></p><p>在弹出的窗口中编辑恶意 JavaScript 即可:</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060022588.png" alt="image-20240506002217510"></p><hr><h2 id="弹窗" tabindex="-1"><a class="header-anchor" href="#弹窗"><span>弹窗</span></a></h2><p>例如弹个窗:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;XSS&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>Adobe 支持自身的 JavaScript 对象模型，例如 alert(‘xss’)必须被 APP 对象调用，因此变成了 app.alert(&#39;xss&#39;)。这意味着，利用 JavaScript 进行攻击时只能使用 Adobe 所支持的功能。</p></blockquote><p>保存文档后打开此PDF文档则会弹窗(例如使用 Edge 打开):</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060028984.png" alt="image-20240506002816946"></p><hr><blockquote><p><a href="https://opensource.adobe.com/dc-acrobat-sdk-docs/library/jsapiref/JS_API_AcroJS.html#app" target="_blank" rel="noopener noreferrer">JavaScript APIs — Acrobat-PDFL SDK: JavaScript Reference (adobe.com)</a></p><p>现在 PDF JavaScript API 限制的比较严格, 似乎无法发起网络请求通信</p><p>除了 PDF 查看器漏洞利用外没有想到什么其他的利用方案</p></blockquote><hr><h2 id="跳转-url" tabindex="-1"><a class="header-anchor" href="#跳转-url"><span>跳转 URL</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">launchURL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://www.example.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202405060133269.png" alt="image-20240506013348197"></p><blockquote><p>PS: 使用 Adobe Acrobat 会提示跳转 URL, 但是使用Edge,Chrome,Firefox打开不会提示也不会打开 URL</p><p>可能会被用于结合文档内容引导用户下载文件, 例如:</p><p><a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rise-in-deceptive-pdf-the-gateway-to-malicious-payloads/" target="_blank" rel="noopener noreferrer">Rise in Deceptive PDF: The Gateway to Malicious Payloads | McAfee Blog</a></p><p><a href="https://www.freebuf.com/articles/network/394052.html" target="_blank" rel="noopener noreferrer">技术详解 | 黑客如何通过PDF文件分发恶意软件 - FreeBuf网络安全行业门户</a></p></blockquote><hr>',28)]))}const l=a(r,[["render",s],["__file","index.html.vue"]]),h=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/PDF/PDF%E5%B5%8C%E5%85%A5JavaScript/","title":"PDF 嵌入 JavaScript","lang":"zh-CN","frontmatter":{"category":["网络安全","网络钓鱼"],"tags":["钓鱼附件","PDF","JavaScript"],"excerpt":"PDF 文件本身支持 JavaScript, 因此攻击者可以创建文件, 在文件打开时执行脚本来下载额外的恶意载荷或者窃取信息","description":"PDF 嵌入 JavaScript 实战|通过恶意 pdf 执行 xss 漏洞 - 网安客 (wanganke.com) PDF 文件本身支持 JavaScript, 因此攻击者可以创建文件, 在文件打开时执行脚本来下载额外的恶意载荷或者窃取信息 下载并安装 迅捷PDF编辑器 - 多功能的PDF编辑软件 (xunjiepdf.com) 新建或打开一个 ...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E9%92%93%E9%B1%BC/%E9%92%93%E9%B1%BC%E9%99%84%E4%BB%B6/PDF/PDF%E5%B5%8C%E5%85%A5JavaScript/"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"PDF 嵌入 JavaScript"}],["meta",{"property":"og:description","content":"PDF 嵌入 JavaScript 实战|通过恶意 pdf 执行 xss 漏洞 - 网安客 (wanganke.com) PDF 文件本身支持 JavaScript, 因此攻击者可以创建文件, 在文件打开时执行脚本来下载额外的恶意载荷或者窃取信息 下载并安装 迅捷PDF编辑器 - 多功能的PDF编辑软件 (xunjiepdf.com) 新建或打开一个 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://cdn.ayusummer233.top/DailyNotes/202405060017522.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-17T03:32:15.000Z"}],["meta",{"property":"article:tag","content":"钓鱼附件"}],["meta",{"property":"article:tag","content":"PDF"}],["meta",{"property":"article:tag","content":"JavaScript"}],["meta",{"property":"article:modified_time","content":"2025-04-17T03:32:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"PDF 嵌入 JavaScript\\",\\"image\\":[\\"http://cdn.ayusummer233.top/DailyNotes/202405060017522.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202405060019088.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202405060020732.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202405060022588.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202405060028984.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202405060133269.png\\"],\\"dateModified\\":\\"2025-04-17T03:32:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2024-05-05T17:44:36.000Z"},"headers":[{"level":2,"title":"弹窗","slug":"弹窗","link":"#弹窗","children":[]},{"level":2,"title":"跳转 URL","slug":"跳转-url","link":"#跳转-url","children":[]}],"git":{"createdTime":1714931076000,"updatedTime":1744860735000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":2,"url":"https://github.com/233Mac"},{"name":"233PC","username":"233PC","email":"ayusummer233@gmail.com","commits":1,"url":"https://github.com/233PC"}]},"readingTime":{"minutes":1.73,"words":519},"filePathRelative":"网络安全/钓鱼/钓鱼附件/PDF/PDF嵌入JavaScript/index.md","localizedDate":"2024年5月5日","autoDesc":true}');export{l as comp,h as data};
