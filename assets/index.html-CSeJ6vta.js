import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,a,o as t}from"./app-DX9gUdjC.js";const n={};function l(r,e){return t(),s("div",null,e[0]||(e[0]=[a(`<h1 id="雷池waf" tabindex="-1"><a class="header-anchor" href="#雷池waf"><span>雷池WAF</span></a></h1><blockquote><p><a href="https://waf-ce.chaitin.cn/" target="_blank" rel="noopener noreferrer">雷池 WAF 社区版 | 下一代 Web 应用防火墙 | 免费使用 (chaitin.cn)</a></p></blockquote><hr><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><blockquote><p><a href="https://docs.waf-ce.chaitin.cn/zh/%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/%E5%AE%89%E8%A3%85%E9%9B%B7%E6%B1%A0/%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer">手动安装雷池 | 雷池 SafeLine (chaitin.cn)</a></p><p><a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Ubuntu | Docker Docs</a></p></blockquote><p>创建雷池目录</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/data/safeline&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-p</code>：如果父目录不存在，则一并创建父目录。</li></ul><p>该命令会创建 <code>/data/safeline</code> 目录作为雷池的安装目录（你可以根据你的实际情况选择安装目录）请确保该目录至少有 5GB 的存储空间（如果日常流量较大，请保证充足的磁盘容量）</p><hr><p>使用下方的命令进入雷池安装目录，并下载 docker compose 编排脚本</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/data/safeline&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;https://waf-ce.chaitin.cn/release/latest/compose.yaml&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291553072.png" alt="image-20241029155347830"></p><hr><p>使用下方的命令进入雷池安装目录，并创建 <code>.env</code> 配置文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/data/safeline&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">touch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;.env&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用文本编辑器打开 <code>.env</code> 文件，写入下方的内容</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">SAFELINE_DIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">{safeline-dir}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">IMAGE_TAG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">MGT_PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">9443</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">POSTGRES_PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">{postgres-password}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">SUBNET_PREFIX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">172.22.222</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">IMAGE_PREFIX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">swr.cn-east-3.myhuaweicloud.com/chaitin-safeline</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>SAFELINE_DIR</strong>: 雷池安装目录，如 <code>/data/safeline</code></li><li><strong>IMAGE_TAG</strong>: 要安装的雷池版本，保持默认的 <code>latest</code> 即可</li><li><strong>MGT_PORT</strong>: 雷池控制台的端口，保持默认的 <code>9443</code> 即可</li><li><strong>POSTGRES_PASSWORD</strong>: 雷池所需数据库的初始化密码，请随机生成一个</li><li><strong>SUBNET_PREFIX</strong>: 雷池内部网络的网段，保持默认的 <code>172.22.222</code> 即可</li><li><strong>IMAGE_PREFIX</strong>: 雷池镜像源的前缀，建议根据服务器地理位置选择合适的源</li></ul><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291557250.png" alt="image-20241029155746138"></p><blockquote><p>根据你的实际情况修改配置文件中的 <code>{safeline-dir}</code> 和 <code>{postgres-password}</code> 字段</p><hr><p>如果使用的是海外服务器或者使用上述国内镜像无法成功拉取的话建议设置 <code>IMAGE_PREFIX=chaitin</code> 直接通过 <a href="http://docker.io/" target="_blank" rel="noopener noreferrer">docker.io</a> 拉取镜像</p><hr><p>REF: <a href="https://233official.github.io/dailynotes/%E9%80%9A%E8%AF%86/Docker/Docker.html#docker-hub-%E6%8D%A2%E6%BA%90" target="_blank" rel="noopener noreferrer">Docker-换源 | DailyNotes (233official.github.io)</a></p></blockquote><hr><p>使用以下命令启动雷池服务</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/data/safeline&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291610538.png" alt="image-20241029161001310"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291611605.png" alt="image-20241029161142563"></p><hr><p>雷池安装成功以后，你可以打开浏览器访问 <code>https://&lt;safeline-ip&gt;:9443/</code> 来使用雷池控制台</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291616731.png" alt="image-20241029161627546"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291617521.png" alt="image-20241029161758473"></p><p>第一次登录雷池需要初始化你的管理员账户（默认会执行），如果没有找到账户密码，手动执行以下命令即可</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> safeline-mgt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resetadmin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>命令执行完成后会随机重置 <code>admin</code> 账户的密码，输出结果如下</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[SafeLine] Initial username：admin</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[SafeLine] Initial password：**********</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[SafeLine] Done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291622424.png" alt="image-20241029162259327"></p><hr><h2 id="快速配置" tabindex="-1"><a class="header-anchor" href="#快速配置"><span>快速配置</span></a></h2><blockquote><p><a href="https://docs.waf-ce.chaitin.cn/%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/%E5%BF%AB%E9%80%9F%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener noreferrer">快速配置 | 雷池 SafeLine (chaitin.cn)</a></p><p><a href="https://rivers.chaitin.cn/discussion" target="_blank" rel="noopener noreferrer">技术讨论 | 长亭百川云 (chaitin.cn)</a></p></blockquote><blockquote><p>如有疑问，可加入 <a href="https://docs.waf-ce.chaitin.cn/wechat.png" target="_blank" rel="noopener noreferrer">雷池微信群</a> 与社区用户共同讨论，或在 <a href="https://rivers.chaitin.cn/discussion" target="_blank" rel="noopener noreferrer">百川论坛</a> 内发帖求助。</p></blockquote><hr><h3 id="雷池工作原理" tabindex="-1"><a class="header-anchor" href="#雷池工作原理"><span>雷池工作原理</span></a></h3><h4 id="反向代理" tabindex="-1"><a class="header-anchor" href="#反向代理"><span>反向代理</span></a></h4><p>雷池基于 <code>Nginx</code> 进行开发, 作为 <code>反向代理</code> 接入网络</p><p>如下图所示, 来自互联网的流量可能是正常用户, 也有可能是恶意用户, 雷池通过在 Web 服务和互联网之间设置一道屏障, 将恶意流量进行阻断.</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291639343.png" alt="img"></p><hr><h4 id="内部逻辑" tabindex="-1"><a class="header-anchor" href="#内部逻辑"><span>内部逻辑</span></a></h4><blockquote><p><a href="https://docs.waf-ce.chaitin.cn/%E6%9B%B4%E5%A4%9A%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B" target="_blank" rel="noopener noreferrer">HTTP 请求在雷池内部流转的过程</a></p></blockquote><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291641536.png" alt="img"></p><hr><h3 id="使用雷池防护一个网站" tabindex="-1"><a class="header-anchor" href="#使用雷池防护一个网站"><span>使用雷池防护一个网站</span></a></h3><p>登录雷池控制台后, 进入 <code>防护站点 - 站点管理</code> 页面, 点击右上角的 <code>添加站点</code> 按钮进行配置.</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291642120.gif" alt="img"></p><ul><li>域名: 通过雷池访问该站点时使用的域名 (支持使用 <code>*</code> 做为通配符)，注意修改 DNS 解析到雷池 IP</li><li>端口: 雷池监听的端口 (如需配置 HTTPS 服务, 请勾选 SSL 选项并配置对应的 SSL 证书)</li><li>上游服务器: 被保护的 Web 服务的实际地址</li></ul><blockquote><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291650385.png" alt="image-20241029165049214"></p></blockquote><hr><h3 id="测试防护效果" tabindex="-1"><a class="header-anchor" href="#测试防护效果"><span>测试防护效果</span></a></h3><p>完成以上步骤后你的雷池已经可以正常工作了, 使用刚才配置的域名和端口访问试试.</p><p>访问后雷池 <code>数据统计</code> 页面的 <code>请求数</code> 若有所增加，那恭喜你, 说明你配置的完全正确. <em>★,°</em>:.☆(￣▽￣)/$:<em>.°★</em> 。</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202410291825636.png" alt="image-20241029182538273"></p><p>更多测试用例请参考 <a href="https://docs.waf-ce.chaitin.cn/%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/%E6%B5%8B%E8%AF%95%E9%98%B2%E6%8A%A4%E6%95%88%E6%9E%9C" target="_blank" rel="noopener noreferrer">测试防护效果</a></p><hr><h3 id="使用高级防护功能" tabindex="-1"><a class="header-anchor" href="#使用高级防护功能"><span>使用高级防护功能</span></a></h3><p>除了常见的 <code>SQL 注入</code>, <code>XSS</code> 等通用 Web 防护能力之外, 雷池还提供了 <code>人机验证</code>, <code>访问频率限制</code>, <code>身份认证</code>, <code>动态防护</code> 等高级防护能力.</p><p>请参考 <a href="https://docs.waf-ce.chaitin.cn/%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/%E9%AB%98%E7%BA%A7%E9%98%B2%E6%8A%A4%E8%83%BD%E5%8A%9B" target="_blank" rel="noopener noreferrer">高级防护能力</a></p><hr><h3 id="其他问题" tabindex="-1"><a class="header-anchor" href="#其他问题"><span>其他问题</span></a></h3><p>请参考<a href="https://docs.waf-ce.chaitin.cn/%E6%9B%B4%E5%A4%9A%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98" target="_blank" rel="noopener noreferrer">配置问题</a></p><hr>`,69)]))}const o=i(n,[["render",l],["__file","index.html.vue"]]),d=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E4%BA%A7%E5%93%81/WAF/%E9%9B%B7%E6%B1%A0WAF/","title":"雷池WAF","lang":"zh-CN","frontmatter":{"category":["网络安全","安全产品"],"tags":["WAF"],"description":"雷池WAF 雷池 WAF 社区版 | 下一代 Web 应用防火墙 | 免费使用 (chaitin.cn) 安装 手动安装雷池 | 雷池 SafeLine (chaitin.cn) Ubuntu | Docker Docs 创建雷池目录 -p：如果父目录不存在，则一并创建父目录。 该命令会创建 /data/safeline 目录作为雷池的安装目录（你可以...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E4%BA%A7%E5%93%81/WAF/%E9%9B%B7%E6%B1%A0WAF/"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"雷池WAF"}],["meta",{"property":"og:description","content":"雷池WAF 雷池 WAF 社区版 | 下一代 Web 应用防火墙 | 免费使用 (chaitin.cn) 安装 手动安装雷池 | 雷池 SafeLine (chaitin.cn) Ubuntu | Docker Docs 创建雷池目录 -p：如果父目录不存在，则一并创建父目录。 该命令会创建 /data/safeline 目录作为雷池的安装目录（你可以..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://cdn.ayusummer233.top/DailyNotes/202410291553072.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-17T03:32:15.000Z"}],["meta",{"property":"article:tag","content":"WAF"}],["meta",{"property":"article:modified_time","content":"2025-04-17T03:32:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"雷池WAF\\",\\"image\\":[\\"http://cdn.ayusummer233.top/DailyNotes/202410291553072.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291557250.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291610538.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291611605.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291616731.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291617521.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291622424.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291639343.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291641536.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291642120.gif\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291650385.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202410291825636.png\\"],\\"dateModified\\":\\"2025-04-17T03:32:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2024-10-30T08:52:29.000Z"},"headers":[{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":2,"title":"快速配置","slug":"快速配置","link":"#快速配置","children":[{"level":3,"title":"雷池工作原理","slug":"雷池工作原理","link":"#雷池工作原理","children":[]},{"level":3,"title":"使用雷池防护一个网站","slug":"使用雷池防护一个网站","link":"#使用雷池防护一个网站","children":[]},{"level":3,"title":"测试防护效果","slug":"测试防护效果","link":"#测试防护效果","children":[]},{"level":3,"title":"使用高级防护功能","slug":"使用高级防护功能","link":"#使用高级防护功能","children":[]},{"level":3,"title":"其他问题","slug":"其他问题","link":"#其他问题","children":[]}]}],"git":{"createdTime":1730278349000,"updatedTime":1744860735000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":4,"url":"https://github.com/233Mac"},{"name":"233","username":"233","email":"ayusummer233@vip.qq.com","commits":1,"url":"https://github.com/233"}]},"readingTime":{"minutes":3.91,"words":1174},"filePathRelative":"网络安全/安全产品/WAF/雷池WAF/index.md","localizedDate":"2024年10月30日","excerpt":"","autoDesc":true}');export{o as comp,d as data};
