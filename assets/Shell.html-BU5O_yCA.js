import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a,o as l}from"./app-DX9gUdjC.js";const t={};function n(h,i){return l(),e("div",null,i[0]||(i[0]=[a(`<h1 id="linux-shell" tabindex="-1"><a class="header-anchor" href="#linux-shell"><span>Linux Shell</span></a></h1><ul><li><a href="#linux-shell">Linux Shell</a><ul><li><a href="#%E6%A6%82%E8%BF%B0">概述</a></li><li><a href="#%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF">获取系统信息</a></li><li><a href="#%E7%B1%BB%E6%B8%85%E5%B1%8F">类清屏</a></li><li><a href="#%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95">历史记录</a></li><li><a href="#%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA%E5%92%8C%E6%97%B6%E9%97%B4">修改时区和时间</a></li><li><a href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86">用户管理</a></li><li><a href="#echo">echo</a></li><li><a href="#%E9%98%B2%E7%81%AB%E5%A2%99%E7%9B%B8%E5%85%B3">防火墙相关</a></li><li><a href="#%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3">网络相关</a><ul><li><a href="#sssocket-statistics">ss(socket statistics)</a></li></ul></li><li><a href="#%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3">进程相关</a><ul><li><a href="#psprocess-status">ps(Process Status)</a></li></ul></li><li><a href="#systemctl">systemctl</a></li><li><a href="#cron-%E8%A1%A8%E8%BE%BE%E5%BC%8F">Cron 表达式</a><ul><li><a href="#%E5%90%84%E5%AD%97%E6%AE%B5%E5%90%AB%E4%B9%89">各字段含义</a></li><li><a href="#%E5%B8%B8%E7%94%A8-cron-%E8%A1%A8%E8%BE%BE%E5%BC%8F">常用 Cron 表达式</a></li></ul></li><li><a href="#%E6%8E%92%E6%9F%A5%E6%9C%8D%E5%8A%A1%E6%98%AF%E6%80%8E%E4%B9%88%E8%B5%B7%E7%9A%84">排查服务是怎么起的</a><ul><li><a href="#%E5%B7%B2%E7%9F%A5%E7%AB%AF%E5%8F%A3">已知端口</a></li></ul></li></ul></li></ul><hr><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><blockquote><p><a href="https://zhuanlan.zhihu.com/p/56532223" target="_blank" rel="noopener noreferrer">Bash 编程入门-1：Shell 与 Bash - 知乎 (zhihu.com)</a></p></blockquote><p>shell 是运行在终端中的文本互动程序，bash(GNU Bourne-Again Shell) 是最常用的一种 shell。是当前大多数 Linux 发行版的默认 Shell。</p><p>其他的 shell 还有：sh、bash、ksh、rsh、csh 等。Ubuntu 系统常用的是 bash，Bio-linux 系统是基于 ubuntu 定制的，但是却使用了 zsh。</p><p>sh 的全名是 Bourne Shell。名字中的玻恩就是这个 Shell 的作者。</p><p>而 bash 的全名是 Bourne Again Shell。最开始在 Unix 系统中流行的是 sh，而 bash 作为 sh 的改进版本，提供了更加丰富的功能。一般来说，都推荐使用 bash 作为默认的 Shell。</p><p>查看当前系统中 shell 的类型:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $SHELL</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/img/20211219065045.png" alt="20211219065045"></p><hr><h2 id="获取系统信息" tabindex="-1"><a class="header-anchor" href="#获取系统信息"><span>获取系统信息</span></a></h2><p><code>uname</code> 命令可用于显示系统信息</p><ul><li><code>-a</code>：显示所有信息</li><li><code>-s</code>：显示内核名称</li><li><code>-n</code>：显示网络节点主机名</li><li><code>-v</code>：显示内核版本</li><li><code>-m</code>：显示机器硬件名称</li><li><code>-p</code>：显示处理器类型</li><li><code>-i</code>：显示硬件平台</li><li><code>-r</code>: 显示内核版本号</li></ul><hr><h2 id="类清屏" tabindex="-1"><a class="header-anchor" href="#类清屏"><span>类清屏</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 清屏</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clear</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指针移到行尾</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Ctrl+L</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="历史记录" tabindex="-1"><a class="header-anchor" href="#历史记录"><span>历史记录</span></a></h2><blockquote><p><a href="https://zhuanlan.zhihu.com/p/371739269" target="_blank" rel="noopener noreferrer">谁动了我的 Linux？原来 history 可以这么强大！ - 知乎 (zhihu.com)</a></p></blockquote><p>使用 history 命令可以查看当前用户执行的历史命令</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">history</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202307251437125.png" alt="image-20230725143721312"></p><p>此外, 每个用户根目录下还都有一个 <code>.bash_history</code> 文件, 也存储了 bash 历史记录:</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202307251500784.png" alt="image-20230725144046356"></p><p>不过这样看到的历史命令没有时间的, 需要时间的话还需要</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> HISTTIMEFORMAT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%Y-%m-%d %T&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者写到 <code>/root/.bashrc</code> 中然后 <code>source /root/.bashrc</code></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 先写个空字符加换行进去</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/root/.bashrc</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;export HISTTIMEFORMAT=&quot;%Y-%m-%d %T&quot;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/root/.bashrc</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /root/.bashrc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样再 history 就能看到带时间的日志了, 不过稍早一些的日志已经无可考证时间了, 毕竟当时执行的时候没保存时间戳</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202307251500923.png" alt="image-20230725150042919"></p><p>此外 <code>.bash_history</code> 并非实时操作的, 正常退出 shell (<code>Ctrl+D</code>, <code>exit</code>)时, shell 进程会把历史记录缓冲区的内容写到 <code>.bash_history</code> 中</p><hr><h2 id="修改时区和时间" tabindex="-1"><a class="header-anchor" href="#修改时区和时间"><span>修改时区和时间</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改时区</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tzdata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -sf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/zoneinfo/Asia/Shanghai</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dpkg-reconfigure</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> noninteractive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tzdata</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202409252353297.png" alt="image-20240925235331225"></p><hr><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改日期</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%Y%m%d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;20240119&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改时间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%T</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;11:20:00&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改日期时间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%Y%m%d%H%M.%S</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;202401191120.00&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202401191124984.png" alt="image-20240119112242251"></p><hr><h2 id="用户管理" tabindex="-1"><a class="header-anchor" href="#用户管理"><span>用户管理</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看当前登录用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">who</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看最近登录的用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">last</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看所用用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/passwd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>新建用户</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> adduser</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> newusername</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h2 id="echo" tabindex="-1"><a class="header-anchor" href="#echo"><span>echo</span></a></h2><blockquote><p><a href="https://phoenixnap.com/kb/echo-command-linux" target="_blank" rel="noopener noreferrer">How to use Echo Command in Linux (With Examples) (phoenixnap.com)</a></p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 帮助文档</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/bin/echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 语法</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [option] [string]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="防火墙相关" tabindex="-1"><a class="header-anchor" href="#防火墙相关"><span>防火墙相关</span></a></h2><blockquote><p><a href="https://sunpma.com/555.html" target="_blank" rel="noopener noreferrer">Debian/Ubuntu/Centos 防火墙放行指定端口 - SunPma&#39;Blog</a></p><p><a href="https://blog.csdn.net/justheretobe/article/details/51843178" target="_blank" rel="noopener noreferrer">ubuntu 的 ufw 如何开放特定端口?_justheretobe 的博客-CSDN 博客_ufw 开放端口</a></p></blockquote><hr><h2 id="网络相关" tabindex="-1"><a class="header-anchor" href="#网络相关"><span>网络相关</span></a></h2><h3 id="ss-socket-statistics" tabindex="-1"><a class="header-anchor" href="#ss-socket-statistics"><span>ss(socket statistics)</span></a></h3><p><code>ss</code> 是用来查看网络连接和套接字信息的工具，比老的 netstat 更快、更现代。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111401502.png" alt="image-20260211140128984"></p><p>常用参数：</p><ul><li>连接/套接字类型 <ul><li><code>-t</code>：TCP</li><li><code>-u</code>：UDP</li><li><code>-w</code>：RAW</li><li><code>-x</code>：UNIX domain sockets</li><li><code>-a</code>：全部（包含 <code>LISTEN</code> / 非 <code>LISTEN</code>）</li><li><code>-l</code>：只看监听（LISTEN）</li></ul></li><li>显示内容 <ul><li><code>-n</code>：不做 DNS/服务名解析（更快，输出纯数字 IP/端口）</li><li><code>-p</code>：显示关联进程（需要权限时用 <code>sudo</code>）</li><li><code>-e</code>：扩展信息（如 uid、inode 等）</li><li><code>-i</code>：更详细的 TCP 内部信息（cwnd、rtt 等，排障常用）</li><li><code>-o</code>：显示定时器信息</li><li><code>-m</code>：显示 socket 内存信息（skmem）</li><li><code>-s</code>：汇总统计（各类连接数等）</li></ul></li><li>协议族/输出格式 <ul><li><code>-4</code> / <code>-6</code>：仅 IPv4 / 仅 IPv6</li><li><code>-H</code>：不输出表头（便于脚本处理）</li></ul></li><li>状态过滤（最常用的“查询条件”） <ul><li><code>state LISTEN</code> / <code>state ESTABLISHED</code> / <code>state TIME-WAIT</code> 等（状态名可用 <code>ss -h</code>/<code>man ss</code> 查全）</li></ul></li></ul><p>常用组合示例：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1) 查看监听端口（TCP），并显示进程, 可以用于溯源端口进程</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -lntp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111408497.png" alt="image-20260211140837199"></p><ul><li><code>-l</code>：只显示监听（LISTEN）的 socket</li><li><code>-n</code>：用数字显示地址/端口（不做解析）</li><li><code>-t</code>：只看 TCP</li><li><code>-p</code>：显示占用该端口的进程（程序名/PID/FD 等，可能需要 sudo 才完整）</li></ul><hr><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2) 查看所有 TCP 连接（不解析），并关注状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ant</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ant</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> established</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ant</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time-wait</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111440512.png" alt="image-20260211144026146"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111443833.png" alt="image-20260211144308550"></p><ul><li><code>-a</code>：全部（包含 <code>LISTEN</code> / 非 <code>LISTEN</code>）</li><li><code>-n</code>：不做 DNS/服务名解析（更快，输出纯数字 IP/端口）</li><li><code>-t</code>：只看 TCP</li></ul><hr><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3) 按端口过滤（dport=目标端口，sport=源端口）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ant</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;( dport = :443 or sport = :443 )&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -lntp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;sport = :22&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111446349.png" alt="image-20260211144601926"></p><p>常用过滤表达式（写在最后一个参数里，建议用引号包起来）：</p><ul><li><code>src &lt;ip&gt;</code> / <code>dst &lt;ip&gt;</code>：按源/目的 IP</li><li><code>sport = :&lt;port&gt;</code> / <code>dport = :&lt;port&gt;</code>：按源/目的端口</li><li><code>net &lt;cidr&gt;</code>：按网段，如 <code>net 10.0.0.0/8</code></li><li>支持 <code>and</code> / <code>or</code> / <code>not</code> 与括号组合：<code>( ... )</code></li></ul><hr><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4) 查看 UDP（常用看 DNS/QUIC 等）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uanp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111447390.png" alt="image-20260211144723166"></p><ul><li><code>-u</code>：UDP</li><li><code>-a</code>：全部（包含 <code>LISTEN</code> / 非 <code>LISTEN</code>）</li><li><code>-n</code>：不做 DNS/服务名解析（更快，输出纯数字 IP/端口）</li><li><code>-p</code>：显示占用该端口的进程（程序名/PID/FD 等，可能需要 sudo 才完整）</li></ul><hr><h2 id="进程相关" tabindex="-1"><a class="header-anchor" href="#进程相关"><span>进程相关</span></a></h2><h3 id="ps-process-status" tabindex="-1"><a class="header-anchor" href="#ps-process-status"><span>ps(Process Status)</span></a></h3><p><code>ps</code> (Process Status) 是 Linux/Unix 系统中用于报告当前进程快照的标准工具。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111503664.png" alt="image-20260211150322427"></p><blockquote><p><code>ps</code> 的参数风格有几种（历史原因），一般会同时看到：</p><ul><li>UNIX 风格：<code>ps -ef</code>、<code>ps -e -o ...</code></li><li>BSD 风格：<code>ps aux</code></li><li>GNU 长参数：<code>ps --sort=-%cpu -eo ...</code></li></ul></blockquote><p>常用参数梳理：</p><ul><li>选择进程（选哪些行） <ul><li><code>-e</code>：所有进程（all processes）</li><li><code>-A</code>：同 <code>-e</code></li><li><code>-p &lt;pid&gt;</code>：按 PID 选择（可逗号分隔，如 <code>-p 1,1234</code>）</li><li><code>-C &lt;comm&gt;</code>：按命令名选择（如 <code>-C nginx</code>）</li></ul></li><li>输出格式（输出哪些列） <ul><li><code>-f</code>：full-format（更详细的默认列）</li><li><code>-o &lt;format&gt;</code>：自定义列（最常用），如 <code>-o pid,ppid,user,%cpu,%mem,etime,cmd</code></li><li><code>-F</code>：extra full format（不同发行版可能略有差异）</li></ul></li><li>排序/头部（GNU/procps 常见） <ul><li><code>--sort &lt;key&gt;</code>：排序（如 <code>--sort=-%cpu</code>、<code>--sort=etime</code>）</li><li><code>--no-headers</code>：不输出表头（便于脚本处理）</li></ul></li></ul><p>常用组合示例：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1) 看所有进程（两种常见写法）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ef</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aux</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1.1) 以树形展示（父子关系）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ef</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --forest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2) 按 PID 查看，并自定义列（排障最常用）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,ppid,user,stat,lstart,etime,cmd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3) 找某个服务/进程（比 grep 更稳：不会把 grep 自己匹配进去）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,ppid,%cpu,%mem,etime,cmd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4) 按 CPU/内存排序，取前 10 个</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -eo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,user,%cpu,%mem,etime,cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --sort=-%cpu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">head</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -eo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,user,%cpu,%mem,etime,cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --sort=-%mem</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">head</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5) 快速看父子关系（更直观通常用 pstree -ap）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -eo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,ppid,cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --sort=ppid</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202602111507442.png" alt="image-20260211150736199"></p><p>常用输出字段速查（<code>-o</code> 常用）：</p><ul><li><code>pid</code> / <code>ppid</code>：进程 ID / 父进程 ID</li><li><code>user</code>：所属用户</li><li><code>%cpu</code> / <code>%mem</code>：CPU/内存占用比例（采样口径依实现而异，用来相对比较更靠谱）</li><li><code>vsz</code> / <code>rss</code>：虚拟内存 / 常驻内存（KB）</li><li><code>lstart</code>：进程启动的完整时间</li><li><code>etime</code>：运行时长（elapsed time）</li><li><code>cmd</code>：完整命令（含参数）</li><li><code>comm</code>：命令名（不含参数）</li><li><code>stat</code>：进程状态（常见：<code>R</code> 运行、<code>S</code> 可中断睡眠、<code>D</code> 不可中断睡眠、<code>T</code> 停止/跟踪、<code>Z</code> 僵尸；后缀如 <code>+</code> 表示前台进程组）</li></ul><hr><h2 id="systemctl" tabindex="-1"><a class="header-anchor" href="#systemctl"><span>systemctl</span></a></h2><p>在 Linux 中，<code>systemctl</code> 是管理 <code>systemd</code>（绝大多数现代 Linux 发行版的初始化系统）的核心工具。</p><p>常用入口：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">man</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">man</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemd.unit</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要看懂命令输出需要了解如下基本概念：</p><ul><li>unit：systemd 管理的对象统称（服务/套接字/定时器/挂载点等） <ul><li><code>*.service</code>：服务</li><li><code>*.socket</code>：socket 激活</li><li><code>*.timer</code>：定时器（类似 cron，但更系统化）</li><li><code>*.target</code>：目标（类似“运行级别”）</li></ul></li><li>system / user 两套实例 <ul><li>默认操作系统级（system）服务</li><li><code>--user</code>：操作当前用户的 systemd（常见于桌面环境/用户守护进程）</li></ul></li></ul><hr><p>常用命令梳理（按使用频率）：</p><ul><li>看状态/排障（最常用） <ul><li><code>systemctl status &lt;unit&gt;</code>：查看状态（含最近日志摘要）</li><li><code>systemctl is-active &lt;unit&gt;</code>：是否正在运行（脚本友好，返回码有意义）</li><li><code>systemctl is-enabled &lt;unit&gt;</code>：是否开机自启</li><li><code>systemctl show &lt;unit&gt; -p &lt;key&gt;</code>：查看某个属性（如 <code>MainPID</code>、<code>ExecStart</code>）</li><li><code>systemctl cat &lt;unit&gt;</code>：查看生效的 unit 文件内容（含 drop-in）</li></ul></li><li>启停与重载 <ul><li><code>systemctl start &lt;unit&gt;</code> / <code>stop &lt;unit&gt;</code>：启动/停止</li><li><code>systemctl restart &lt;unit&gt;</code>：重启</li><li><code>systemctl reload &lt;unit&gt;</code>：通知服务 reload（前提是 unit 支持）</li><li><code>systemctl try-restart &lt;unit&gt;</code>：仅当已运行时才重启</li></ul></li><li>开机自启/禁用 <ul><li><code>systemctl enable &lt;unit&gt;</code> / <code>disable &lt;unit&gt;</code>：启用/禁用自启（通常是创建/删除软链）</li><li><code>systemctl mask &lt;unit&gt;</code> / <code>unmask &lt;unit&gt;</code>：更强的禁止（防止被依赖拉起）</li></ul></li><li>列表/搜索 <ul><li><code>systemctl list-units --type=service --all</code>：列出（已加载的）服务 unit</li><li><code>systemctl list-unit-files --type=service</code>：列出（已安装的）unit 文件及 enable 状态</li></ul></li><li>unit 文件变更后 <ul><li><code>systemctl daemon-reload</code>：重新加载 unit 定义（改了 unit 文件必做）</li><li><code>systemctl restart &lt;unit&gt;</code>：让变更生效（对 running 的服务）</li></ul></li></ul><p>常用组合示例：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1) 查看服务状态（服务名通常省略 .service 也可以）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2) 启动/停止/重启/重载</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3) 设置开机自启，并立即启动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --now</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4) 取消开机自启，并立即停止</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --now</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5) 列出失败的服务（排障入口）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --failed</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6) 看 unit 的关键信息（脚本友好）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MainPID</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ActiveState</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SubState</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ExecStart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>systemctl show</code>：输出 unit 的“属性”（key=value），适合脚本与精确定位问题</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 看全部属性（输出很长）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 只看关心的属性（推荐）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FragmentPath</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DropInPaths</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UnitFileState</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MainPID</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ExecMainPID</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ExecMainStatus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ActiveState</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SubState</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Result</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 只输出 value（便于脚本）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MainPID</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --value</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>systemctl cat</code>：输出“生效的 unit 文件内容”（包含 drop-in 覆盖），比直接 <code>cat /lib/systemd/system/*.service</code> 更接近真实配置</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>unit 文件位置与覆盖：</p><ul><li>发行版自带/包管理安装：<code>/lib/systemd/system/</code>（有的发行版是 <code>/usr/lib/systemd/system/</code>）</li><li>管理员自定义：<code>/etc/systemd/system/</code>（优先级更高）</li><li>drop-in 覆盖目录：<code>/etc/systemd/system/&lt;unit&gt;.d/*.conf</code></li></ul><p>常用覆盖/改配置姿势：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打开一个 drop-in 覆盖文件（推荐做法，不直接改 /lib/...）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> edit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果你确实想“完整覆盖”原 unit 文件（一般不推荐）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> edit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --full</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改后</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>日志查看常和 <code>journalctl</code> 配合：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="cron-表达式" tabindex="-1"><a class="header-anchor" href="#cron-表达式"><span>Cron 表达式</span></a></h2><blockquote><p><a href="https://cloud.tencent.com/developer/article/1674682" target="_blank" rel="noopener noreferrer">cron 表达式详解 - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p></blockquote><p>Cron 是类 Unix 操作系统中一个基于时间的工作调度器, Cron 表达式使用字符串标识, 定义了一个 Cron 工作的运行时间, 由 6 个或 7 个字段组成, 各字段按照先后顺序分别标识 <code>分钟 小时 月份中的天(1-31) 月份 星期几 年份(可选)</code></p><p>例如如下表达式表示在每天 <code>0:00</code> 运行任务: <code>0 0 * * *</code></p><hr><h3 id="各字段含义" tabindex="-1"><a class="header-anchor" href="#各字段含义"><span>各字段含义</span></a></h3><table><thead><tr><th style="text-align:center;">字段</th><th style="text-align:center;">允许值</th><th style="text-align:center;">允许的特殊字符</th></tr></thead><tbody><tr><td style="text-align:center;">秒(Seconds)</td><td style="text-align:center;">0~59 的整数</td><td style="text-align:center;"><code>, - * /</code></td></tr><tr><td style="text-align:center;">分(Minutes)</td><td style="text-align:center;">0~59 的整数</td><td style="text-align:center;"><code>, - * /</code></td></tr><tr><td style="text-align:center;">小时(Hours)</td><td style="text-align:center;">0~23 的整数</td><td style="text-align:center;"><code>, - * /</code></td></tr><tr><td style="text-align:center;">日期(DayofMonth)</td><td style="text-align:center;">1~31 的整数(但是你需要考虑你月的天数)</td><td style="text-align:center;"><code>,- * ? / L W C</code></td></tr><tr><td style="text-align:center;">月份(Month)</td><td style="text-align:center;">1~12 的整数或者 JAN-DEC</td><td style="text-align:center;"><code>, - * /</code></td></tr><tr><td style="text-align:center;">星期(DayofWeek)</td><td style="text-align:center;">1~7 的整数或者 SUN-SAT (1=SUN)</td><td style="text-align:center;"><code>, - * ? / L C #</code></td></tr><tr><td style="text-align:center;">年(可选)(Year)</td><td style="text-align:center;">1970~2099</td><td style="text-align:center;"><code>, - * /</code></td></tr></tbody></table><blockquote><p>由于调度作业通常不需要秒字段, 因此很多情况下 5 个字段的 cron 表达式就足够表示需要的时间了, 当一个 cron 表达式只有 5 个字段时, 其等效于秒字段为 0 其他字段与其相同的 cron 表达式</p></blockquote><ul><li><p><code>:</code> 匹配任意值, 即在每个当前域的每个时间单位都触发一次, 比如用在 <code>分</code> 内则表示每分钟触发一次</p></li><li><p><code>?</code> 只能用在 <code>日期(DayofMonth)</code> 和 <code>星期(DayofWeek)</code> 两个域, 含义与 <code>*</code> 相似但不同, 比如</p></li><li><p><code>-</code> 表示范围, 如 <code>时</code> 字段为 <code>9-17</code> 表示 <code>[9时, 17时]</code></p></li><li><p><code>/</code> 表示起始时间每隔固定时间触发一次, 比如 <code>时</code> 字段为 <code>9-17/2</code> 表示 <code>[9时, 17时]</code> 间每 2h 触发一次</p></li><li><p><code>,</code> 表示枚举, 比如 <code>时</code> 字段为 <code>9,17</code> 表示在 9 时与 17 时分别触发一次</p></li><li><p><code>L</code> 表示最后, 只能用在 <code>日期(DayofMonth)</code> 和 <code>星期(DayofWeek)</code> 两个域; 如果在 DayofWeek 域使用 5L,意味着在最后的一个星期四触发。</p></li><li><p><code>W</code> 表示有效工作日(周一到周五),只能出现在 DayofMonth 域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth 使用 5W</p><ul><li>如果 5 日是星期六，则将在最近的工作日：星期五，即 4 日触发。</li><li>如果 5 日是星期天，则在 6 日(周一)触发；</li><li>如果 5 日在星期一到星期五中的一天，则就在 5 日触发</li></ul><blockquote><ul><li>W 的最近寻找不会跨过月份</li><li>LW 这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。</li></ul></blockquote></li><li><p><code>#</code> 用于确定每个月第几个星期几，只能出现在 DayofWeek 域。例如在 4#2，表示某月的第二个星期三</p></li></ul><hr><h3 id="常用-cron-表达式" tabindex="-1"><a class="header-anchor" href="#常用-cron-表达式"><span>常用 Cron 表达式</span></a></h3><table><thead><tr><th style="text-align:center;">含义</th><th style="text-align:center;">Cron 表达式</th></tr></thead><tbody><tr><td style="text-align:center;">周一到周五九点触发</td><td style="text-align:center;"><code>0 9 * * 1-5</code></td></tr><tr><td style="text-align:center;">每个工作日的 9-19 点之间的每两个小时触发</td><td style="text-align:center;"><code>0 9-19/2 * * 1-5</code></td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td></tr></tbody></table><hr><h2 id="排查服务是怎么起的" tabindex="-1"><a class="header-anchor" href="#排查服务是怎么起的"><span>排查服务是怎么起的</span></a></h2><blockquote><p><a href="https://github.com/pranshuparmar/witr" target="_blank" rel="noopener noreferrer">Why is this running? / github.com/pranshuparmar/witr</a></p></blockquote><hr><h3 id="已知端口" tabindex="-1"><a class="header-anchor" href="#已知端口"><span>已知端口</span></a></h3><p>先用 <code>ss</code> 查端口对应服务 PID， 然后查 PID 对应进程及其 PPID 捋到根进程, 例如：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -lntp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;:8080\\b&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><p><code>-l</code>：只显示监听（LISTEN）的 socket</p></li><li><p><code>-n</code>：用数字显示地址/端口（不做解析）</p></li><li><p><code>-t</code>：只看 TCP</p></li><li><p><code>-p</code>：显示占用该端口的进程（程序名/PID/FD 等，可能需要 sudo 才完整）</p></li><li><p><code>| grep &#39;:8080\\b&#39;</code></p><ul><li><p>管道把 ss 输出交给 grep 过滤</p></li><li><p><code>\\b</code> 是一个<strong>正则边界符</strong>。它的作用是确保匹配到此为止。</p><blockquote><p>在正则表达式中，单词字符（Word Characters）通常指：</p><ul><li><strong>字母</strong> (<code>a-z</code>, <code>A-Z</code>)</li><li><strong>数字</strong> (<code>0-9</code>)</li><li><strong>下划线</strong> (<code>_</code>)</li></ul><p>除此之外的所有字符（空格、标点符号、换行符、冒号、甚至是特殊符号）都被视为“非单词字符”。</p><p><code>\\b</code> 就像是一个哨兵，它守在两个字符的中间。只有当一侧是“数字/字母”，另一侧是“空格/标点/开头/结尾”时，它才允许匹配。</p></blockquote></li></ul></li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">上一步看到的PID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid,ppid,user,stime,etime,cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;\\0&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39; &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/proc/&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/cmdline</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ps</code> <code>-o</code> 参数允许你<strong>自定义输出列</strong>。只有你指定的字段会被显示：</p><table><thead><tr><th><strong>字段</strong></th><th><strong>全称</strong></th><th><strong>含义</strong></th></tr></thead><tbody><tr><td><strong><code>pid</code></strong></td><td>Process ID</td><td><strong>进程 ID</strong>：进程的唯一数字标识。</td></tr><tr><td><strong><code>ppid</code></strong></td><td>Parent Process ID</td><td><strong>父进程 ID</strong>：启动该进程的进程 ID。</td></tr><tr><td><strong><code>user</code></strong></td><td>User Name</td><td><strong>运行用户</strong>：拥有该进程的用户名称。</td></tr><tr><td><strong><code>stime</code></strong></td><td>Start Time</td><td><strong>启动时间</strong>：进程开始运行的具体时刻（如 <code>14:30</code>）。</td></tr><tr><td><strong><code>etime</code></strong></td><td>Elapsed Time</td><td><strong>持续时间</strong>：进程自启动以来运行的总时长，格式通常为 <code>[[DD-]hh:]mm:ss</code>。</td></tr><tr><td><strong><code>cmd</code></strong></td><td>Command</td><td><strong>命令行</strong>：启动该进程时使用的完整命令及其参数。</td></tr></tbody></table><p><code>-p</code>: 告诉 <code>ps</code> 只关注特定的进程 ID。</p><hr><p>Linux 内核在 <code>/proc/[pid]/cmdline</code> 文件中存储数据的方式比较特别。</p><p>在 Linux 系统中，<code>/proc/&quot;$pid&quot;/cmdline</code> 包含了进程启动时的完整命令行参数。但为了方便程序解析，内核使用 <strong>空字符 (Null Character, <code>\\0</code>)</strong> 而不是空格来分隔各个参数。</p><p>如果直接执行 <code>cat /proc/&quot;$pid&quot;/cmdline</code>，所有的参数会连在一起，或者在某些终端里完全无法显示。</p><ul><li><p><code>tr &#39;\\0&#39; &#39; &#39;</code>: 将输入流中所有的空字符替换成空格，从而让原本挤在一起的参数变得易于阅读。</p><ul><li><p><strong><code>tr</code></strong>: 字符转换工具（translate）。</p></li><li><p><strong><code>&#39;\\0&#39;</code></strong>: 代表空字符（Null）。</p></li><li><p><strong><code>&#39; &#39;</code></strong>: 代表标准的空格。</p></li></ul></li><li><p><code>&lt; /proc/&quot;$pid&quot;/cmdline</code></p><p><strong><code>&lt;</code></strong> 是输入重定向。它告诉 <code>tr</code> 命令不要等待键盘输入，而是从后面这个文件中读取内容。</p></li><li><p><code>; echo</code></p><ul><li><strong><code>;</code></strong>: 命令分隔符，表示前一个命令执行完后，接着执行下一个。</li><li><strong><code>echo</code></strong>: 在最后输出一个<strong>换行符</strong>。因为 <code>cmdline</code> 文件结尾通常没有换行符，如果不加这一句，终端提示符会紧跟在输出结果的末尾，看起来很乱。</li></ul></li></ul><hr>`,143)]))}const r=s(t,[["render",n],["__file","Shell.html.vue"]]),c=JSON.parse('{"path":"/%E9%80%9A%E8%AF%86/Linux/Shell.html","title":"Linux Shell","lang":"zh-CN","frontmatter":{"description":"Linux Shell Linux Shell 概述 获取系统信息 类清屏 历史记录 修改时区和时间 用户管理 echo 防火墙相关 网络相关 ss(socket statistics) 进程相关 ps(Process Status) systemctl Cron 表达式 各字段含义 常用 Cron 表达式 排查服务是怎么起的 已知端口 概述 Bash...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/%E9%80%9A%E8%AF%86/Linux/Shell.html"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"Linux Shell"}],["meta",{"property":"og:description","content":"Linux Shell Linux Shell 概述 获取系统信息 类清屏 历史记录 修改时区和时间 用户管理 echo 防火墙相关 网络相关 ss(socket statistics) 进程相关 ps(Process Status) systemctl Cron 表达式 各字段含义 常用 Cron 表达式 排查服务是怎么起的 已知端口 概述 Bash..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://cdn.ayusummer233.top/img/20211219065045.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-11T07:40:59.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-11T07:40:59.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Linux Shell\\",\\"image\\":[\\"http://cdn.ayusummer233.top/img/20211219065045.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202307251437125.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202307251500784.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202307251500923.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202409252353297.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202401191124984.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111401502.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111408497.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111440512.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111443833.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111446349.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111447390.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111503664.png\\",\\"http://cdn.ayusummer233.top/DailyNotes/202602111507442.png\\"],\\"dateModified\\":\\"2026-02-11T07:40:59.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2024-09-24T07:04:16.000Z"},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"获取系统信息","slug":"获取系统信息","link":"#获取系统信息","children":[]},{"level":2,"title":"类清屏","slug":"类清屏","link":"#类清屏","children":[]},{"level":2,"title":"历史记录","slug":"历史记录","link":"#历史记录","children":[]},{"level":2,"title":"修改时区和时间","slug":"修改时区和时间","link":"#修改时区和时间","children":[]},{"level":2,"title":"用户管理","slug":"用户管理","link":"#用户管理","children":[]},{"level":2,"title":"echo","slug":"echo","link":"#echo","children":[]},{"level":2,"title":"防火墙相关","slug":"防火墙相关","link":"#防火墙相关","children":[]},{"level":2,"title":"网络相关","slug":"网络相关","link":"#网络相关","children":[{"level":3,"title":"ss(socket statistics)","slug":"ss-socket-statistics","link":"#ss-socket-statistics","children":[]}]},{"level":2,"title":"进程相关","slug":"进程相关","link":"#进程相关","children":[{"level":3,"title":"ps(Process Status)","slug":"ps-process-status","link":"#ps-process-status","children":[]}]},{"level":2,"title":"systemctl","slug":"systemctl","link":"#systemctl","children":[]},{"level":2,"title":"Cron 表达式","slug":"cron-表达式","link":"#cron-表达式","children":[{"level":3,"title":"各字段含义","slug":"各字段含义","link":"#各字段含义","children":[]},{"level":3,"title":"常用 Cron 表达式","slug":"常用-cron-表达式","link":"#常用-cron-表达式","children":[]}]},{"level":2,"title":"排查服务是怎么起的","slug":"排查服务是怎么起的","link":"#排查服务是怎么起的","children":[{"level":3,"title":"已知端口","slug":"已知端口","link":"#已知端口","children":[]}]}],"git":{"createdTime":1727161456000,"updatedTime":1770795659000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":3,"url":"https://github.com/233Mac"},{"name":"233PC","username":"233PC","email":"ayusummer233@gmail.com","commits":1,"url":"https://github.com/233PC"},{"name":"233","username":"233","email":"ayusummer233@vip.qq.com","commits":2,"url":"https://github.com/233"}]},"readingTime":{"minutes":14.01,"words":4204},"filePathRelative":"通识/Linux/Shell.md","localizedDate":"2024年9月24日","excerpt":"","autoDesc":true}');export{r as comp,c as data};
