import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a as i,d as n,o as t,r}from"./app-DX9gUdjC.js";const h="/dailynotes/assets/%E5%BD%93%E5%89%8D%E7%BB%84%E7%BD%91-DfNGd16l.svg",p={};function d(o,s){const e=r("Mermaid");return t(),l("div",null,[s[0]||(s[0]=i('<h1 id="gl-mt3000刷openwrt作为末端无线面板接入mesh组网" tabindex="-1"><a class="header-anchor" href="#gl-mt3000刷openwrt作为末端无线面板接入mesh组网"><span>GL-MT3000刷Openwrt作为末端无线面板接入mesh组网</span></a></h1><blockquote><p>OpenWrt 旁路由 + redsocks + Surge 实现「单设备定向代理」</p><p><strong>目标</strong>： 在 <strong>不改变现有有线 Mesh 网络结构</strong> 的前提下，通过一台 <strong>刷了OpenWrt的GL-MT3000</strong>， 让 <strong>指定的一台设备（投影仪）</strong> 的流量，经由 <strong>局域网内手机 Surge 提供的 SOCKS5 代理</strong> 转发访问目标站点。</p></blockquote><hr><h2 id="一、背景与原始需求-why" tabindex="-1"><a class="header-anchor" href="#一、背景与原始需求-why"><span>一、背景与原始需求（Why）</span></a></h2><h3 id="_1-原始网络环境" tabindex="-1"><a class="header-anchor" href="#_1-原始网络环境"><span>1. 原始网络环境</span></a></h3><ul><li><p>主路由：<strong>小米路由器</strong>（负责 DHCP / Mesh / 主网关）</p></li><li><p>网络形态：<strong>有线 Mesh + 多 AP</strong></p></li><li><p>局域网网段：<code>192.168.31.0/24</code></p></li><li><p>已有情况：</p><ul><li>局域网内 <strong>大多数设备已可正常代理</strong>（PC / 手机 / NAS）</li><li><strong>投影仪</strong> 无法自行配置代理</li></ul></li></ul><p><img src="'+h+`" alt="当前组网"></p><hr><h3 id="_2-核心痛点" tabindex="-1"><a class="header-anchor" href="#_2-核心痛点"><span>2. 核心痛点</span></a></h3><ul><li>❌ 不想改动现有 Mesh 结构</li><li>❌ 不想让全网都走代理</li><li>❌ 投影仪本身 <strong>不支持代理配置</strong></li></ul><h3 id="_3-解决方向" tabindex="-1"><a class="header-anchor" href="#_3-解决方向"><span>3. 解决方向</span></a></h3><p>明确<strong>约束条件</strong>：</p><ol><li><strong>不改主路由、不动 Mesh</strong></li><li><strong>只代理一台设备</strong>（而不是一个网段）</li><li><strong>代理服务器已经存在</strong>（手机 Surge 或者局域网内其他设备的代理）</li></ol><p>排除：</p><ul><li>❌ 改主路由透明代理</li><li>❌ 改 DHCP 默认网关</li><li>❌ 投影仪刷系统 / 装插件</li></ul><p>最终自然收敛到：</p><blockquote><p>✅ <strong>软路由 / 旁路由 + 精确流量劫持</strong></p></blockquote><hr><h2 id="二、方案选择与硬件落地-what" tabindex="-1"><a class="header-anchor" href="#二、方案选择与硬件落地-what"><span>二、方案选择与硬件落地（What）</span></a></h2><h3 id="_1-为什么选择旁路由方案" tabindex="-1"><a class="header-anchor" href="#_1-为什么选择旁路由方案"><span>1. 为什么选择旁路由方案</span></a></h3><p>旁路由具备几个天然优势：</p><ul><li>不破坏原网络</li><li>可精确控制策略</li><li>可随时下线、回滚</li><li>不影响其他设备</li></ul><h3 id="_2-硬件选择-gl-mt3000" tabindex="-1"><a class="header-anchor" href="#_2-硬件选择-gl-mt3000"><span>2. 硬件选择：GL-MT3000</span></a></h3><p>选择 <strong>GL-MT3000（Filogic 830）</strong> 的原因：</p><ul><li>性能充足（A53 + 硬件 NAT）</li><li>社区成熟</li><li>官方支持 OpenWrt</li><li>体积小、功耗低</li></ul><h3 id="_3-实际落地步骤概览" tabindex="-1"><a class="header-anchor" href="#_3-实际落地步骤概览"><span>3. 实际落地步骤概览</span></a></h3><ol><li>购入 MT3000</li><li>刷入 OpenWrt 24.x</li><li>配置为 <strong>旁路由模式</strong></li><li>投影仪接入 MT3000 的 Wi‑Fi</li></ol><hr><h2 id="三、旁路由部署中的关键经验-how-part-1" tabindex="-1"><a class="header-anchor" href="#三、旁路由部署中的关键经验-how-part-1"><span>三、旁路由部署中的关键经验（How - Part 1）</span></a></h2><h3 id="_1-lan-wan-dhcp-的关键认知" tabindex="-1"><a class="header-anchor" href="#_1-lan-wan-dhcp-的关键认知"><span>1. LAN / WAN / DHCP 的关键认知</span></a></h3><p>在部署过程中，遇到过的关键坑包括：</p><h4 id="❌-误区" tabindex="-1"><a class="header-anchor" href="#❌-误区"><span>❌ 误区</span></a></h4><ul><li>关闭 DHCP 后误以为设备仍可自动访问</li><li>在 <code>192.168.31.x</code> 网络中手动给 PC 配 <code>192.168.1.x</code></li><li>混淆 <strong>WAN MAC</strong> 与 <strong>LAN MAC</strong></li></ul><h4 id="✅-正确认知" tabindex="-1"><a class="header-anchor" href="#✅-正确认知"><span>✅ 正确认知</span></a></h4><ul><li>WebUI 是否可访问 <strong>取决于 IP 是否同网段</strong></li><li>DHCP 关闭后，<strong>必须手动配置 IP / 网关 / DNS</strong></li><li>IP-MAC 绑定一定要确认 <strong>接口 MAC</strong></li></ul><hr><h2 id="四、代理实现方案的演进-how-part-2" tabindex="-1"><a class="header-anchor" href="#四、代理实现方案的演进-how-part-2"><span>四、代理实现方案的演进（How - Part 2）</span></a></h2><h3 id="_1-为什么选择-redsocks" tabindex="-1"><a class="header-anchor" href="#_1-为什么选择-redsocks"><span>1. 为什么选择 redsocks</span></a></h3><p>redsocks 的角色非常清晰：</p><ul><li>不负责分流</li><li>不负责规则</li><li><strong>只负责把“被劫持的 TCP 流量”转成 SOCKS5</strong></li></ul><p>这正好匹配：</p><blockquote><p>Surge = 代理服务器 OpenWrt = 流量入口</p></blockquote><h3 id="_2-redsocks-最小可用配置" tabindex="-1"><a class="header-anchor" href="#_2-redsocks-最小可用配置"><span>2. redsocks 最小可用配置</span></a></h3><div class="language-conf line-numbers-mode" data-highlighter="shiki" data-ext="conf" data-title="conf" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>base {</span></span>
<span class="line"><span>  log_info = on;</span></span>
<span class="line"><span>  log_debug = off;</span></span>
<span class="line"><span>  daemon = on;</span></span>
<span class="line"><span>  redirector = iptables;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>redsocks {</span></span>
<span class="line"><span>  local_ip = 127.0.0.1;</span></span>
<span class="line"><span>  local_port = 12345;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ip = 192.168.31.208;   # Surge 手机 IP</span></span>
<span class="line"><span>  port = 6153;           # Surge SOCKS5 端口</span></span>
<span class="line"><span>  type = socks5;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>关键理解</strong>： 配置文件行数 ≠ 稳定性 redsocks 只需要描述一件事： “本地端口 → 代理服务器”</p></blockquote><hr><h2 id="五、iptables-→-nftables-→-fw4-的真实迁移过程-how-part-3" tabindex="-1"><a class="header-anchor" href="#五、iptables-→-nftables-→-fw4-的真实迁移过程-how-part-3"><span>五、iptables → nftables → fw4 的真实迁移过程（How - Part 3）</span></a></h2><h3 id="_1-为什么-iptables-行不通" tabindex="-1"><a class="header-anchor" href="#_1-为什么-iptables-行不通"><span>1. 为什么 iptables 行不通</span></a></h3><p>在 OpenWrt 24.x：</p><ul><li>iptables = <strong>兼容层（xtables-nft）</strong></li><li>REDIRECT / nat 行为受限</li><li>kernel module 经常缺失</li></ul><p>典型错误：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Warning: Extension REDIRECT revision 0 not supported</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-手写-nftables-的风险" tabindex="-1"><a class="header-anchor" href="#_2-手写-nftables-的风险"><span>2. 手写 nftables 的风险</span></a></h3><p>虽然 nft 是底层，但：</p><ul><li>fw4 会重新渲染规则</li><li>手写 table / chain 极易破坏系统防火墙</li></ul><p>你已经亲身验证：</p><blockquote><p>❌ 直接写 <code>/etc/nftables.d/*.nft</code> 非常容易炸防火墙</p></blockquote><h3 id="_3-正确答案-fw4-uci" tabindex="-1"><a class="header-anchor" href="#_3-正确答案-fw4-uci"><span>3. 正确答案：fw4 + UCI</span></a></h3><blockquote><p><strong>结论</strong>： 在 OpenWrt 24.x， <strong>一切 NAT / REDIRECT，都应该通过 UCI firewall 完成</strong></p></blockquote><hr><h2 id="六、最终正确方案-how-part-4" tabindex="-1"><a class="header-anchor" href="#六、最终正确方案-how-part-4"><span>六、最终正确方案（How - Part 4）</span></a></h2><h3 id="_1-用-uci-声明式创建重定向规则" tabindex="-1"><a class="header-anchor" href="#_1-用-uci-声明式创建重定向规则"><span>1. 用 UCI 声明式创建重定向规则</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redirect</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].name=&#39;proj_to_redsocks&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].src=&#39;lan&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].family=&#39;ipv4&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].proto=&#39;tcp&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].src_mac=&#39;64:57:25:5A:DA:48&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].src_dport=&#39;1-65535&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].dest_ip=&#39;127.0.0.1&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].dest_port=&#39;12345&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall.@redirect[-1].target=&#39;DNAT&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewall</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/etc/init.d/firewall</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-数据流向图-mermaid" tabindex="-1"><a class="header-anchor" href="#_2-数据流向图-mermaid"><span>2. 数据流向图（Mermaid）</span></a></h3>`,64)),n(e,{id:"mermaid-382",code:"eJxLL0osyFAIceFSAALH6GddU5/u3fhk9youX0dnBTMTK1NzKyNTK1NHKxdHKxOLWIgyBV1du5oQ5wCFZ1sbX7b31yg4RfuGGBsYGCgkFenmJOZBlDmBlaWVmyi4+DmG1Cg4RxsamesZAKGhlaGRsYkpRJkzWFlRakpxfnJ2cY2CS3RwaVF6qsKzzu5nc3ZxGVoa6RmaWegZG+oZGVhYmRmaGkP0uYD0KbhGP5+97tmC9uerZz5v2hnLBQANXEFk"}),s[1]||(s[1]=i('<hr><h2 id="七、验证与成功判据-how-part-5" tabindex="-1"><a class="header-anchor" href="#七、验证与成功判据-how-part-5"><span>七、验证与成功判据（How - Part 5）</span></a></h2><h3 id="_1-redsocks-是否监听" tabindex="-1"><a class="header-anchor" href="#_1-redsocks-是否监听"><span>1. redsocks 是否监听</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -lnpt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12345</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-fw4-规则是否正确生成" tabindex="-1"><a class="header-anchor" href="#_2-fw4-规则是否正确生成"><span>2. fw4 规则是否正确生成</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fw4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redsocks</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>看到类似：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>meta nfproto ipv4 tcp dport 1-65535 ether saddr 64:57:25:5a:da:48 dnat 127.0.0.1:12345</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>即为 <strong>成功状态</strong>。</p><hr><h2 id="八、常见问题与排错总结-troubleshooting" tabindex="-1"><a class="header-anchor" href="#八、常见问题与排错总结-troubleshooting"><span>八、常见问题与排错总结（Troubleshooting）</span></a></h2><h3 id="q1-为什么-webui-访问不了" tabindex="-1"><a class="header-anchor" href="#q1-为什么-webui-访问不了"><span>Q1：为什么 WebUI 访问不了？</span></a></h3><ul><li>IP 不在同一网段</li><li>DHCP 关闭但客户端未手动配置</li></ul><h3 id="q2-iptables-明明装了却不能用" tabindex="-1"><a class="header-anchor" href="#q2-iptables-明明装了却不能用"><span>Q2：iptables 明明装了却不能用？</span></a></h3><ul><li>OpenWrt 24.x 使用 nftables</li><li>iptables 只是兼容外壳</li></ul><h3 id="q3-nftables-语法总报错" tabindex="-1"><a class="header-anchor" href="#q3-nftables-语法总报错"><span>Q3：nftables 语法总报错？</span></a></h3><ul><li>fw4 会二次渲染</li><li>手写规则极易破坏系统</li></ul><h3 id="q4-为什么-dnat-报-transport-protocol-mapping" tabindex="-1"><a class="header-anchor" href="#q4-为什么-dnat-报-transport-protocol-mapping"><span>Q4：为什么 DNAT 报 “transport protocol mapping”？</span></a></h3><ul><li>缺少 <code>proto tcp</code></li><li>fw4 需要明确 L4 协议</li></ul><hr><h2 id="九、最终总结-takeaways" tabindex="-1"><a class="header-anchor" href="#九、最终总结-takeaways"><span>九、最终总结（Takeaways）</span></a></h2><ol><li><strong>旁路由是最优解</strong>，不是折中方案</li><li><strong>redsocks 只做一件事，反而最稳定</strong></li><li><strong>OpenWrt 24.x 必须拥抱 fw4 + UCI</strong></li><li><strong>声明式配置 &gt; 手工命令</strong></li></ol><blockquote><p>这次不是“折腾成功”， 而是完整掌握了一条 <strong>现代 OpenWrt 的正确工程路径</strong>。</p></blockquote><hr><p>（完）</p>',25))])}const g=a(p,[["render",d],["__file","GL-MT3000刷Openwrt作为末端无线面板接入mesh组网.html.vue"]]),u=JSON.parse('{"path":"/DailyLife/%E7%BB%84%E7%BD%91/GL-MT3000%E5%88%B7Openwrt%E4%BD%9C%E4%B8%BA%E6%9C%AB%E7%AB%AF%E6%97%A0%E7%BA%BF%E9%9D%A2%E6%9D%BF%E6%8E%A5%E5%85%A5mesh%E7%BB%84%E7%BD%91.html","title":"GL-MT3000刷Openwrt作为末端无线面板接入mesh组网","lang":"zh-CN","frontmatter":{"description":"GL-MT3000刷Openwrt作为末端无线面板接入mesh组网 OpenWrt 旁路由 + redsocks + Surge 实现「单设备定向代理」 目标： 在 不改变现有有线 Mesh 网络结构 的前提下，通过一台 刷了OpenWrt的GL-MT3000， 让 指定的一台设备（投影仪） 的流量，经由 局域网内手机 Surge 提供的 SOCKS5...","head":[["meta",{"property":"og:url","content":"https://233official.github.io/dailynotes/DailyLife/%E7%BB%84%E7%BD%91/GL-MT3000%E5%88%B7Openwrt%E4%BD%9C%E4%B8%BA%E6%9C%AB%E7%AB%AF%E6%97%A0%E7%BA%BF%E9%9D%A2%E6%9D%BF%E6%8E%A5%E5%85%A5mesh%E7%BB%84%E7%BD%91.html"}],["meta",{"property":"og:site_name","content":"DailyNotes"}],["meta",{"property":"og:title","content":"GL-MT3000刷Openwrt作为末端无线面板接入mesh组网"}],["meta",{"property":"og:description","content":"GL-MT3000刷Openwrt作为末端无线面板接入mesh组网 OpenWrt 旁路由 + redsocks + Surge 实现「单设备定向代理」 目标： 在 不改变现有有线 Mesh 网络结构 的前提下，通过一台 刷了OpenWrt的GL-MT3000， 让 指定的一台设备（投影仪） 的流量，经由 局域网内手机 Surge 提供的 SOCKS5..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-16T07:02:26.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-16T07:02:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"GL-MT3000刷Openwrt作为末端无线面板接入mesh组网\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-16T07:02:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"咸鱼型233\\",\\"url\\":\\"https://233official.github.io/dailynotes/\\"}]}"]],"date":"2025-12-16T07:02:26.000Z"},"headers":[{"level":2,"title":"一、背景与原始需求（Why）","slug":"一、背景与原始需求-why","link":"#一、背景与原始需求-why","children":[{"level":3,"title":"1. 原始网络环境","slug":"_1-原始网络环境","link":"#_1-原始网络环境","children":[]},{"level":3,"title":"2. 核心痛点","slug":"_2-核心痛点","link":"#_2-核心痛点","children":[]},{"level":3,"title":"3. 解决方向","slug":"_3-解决方向","link":"#_3-解决方向","children":[]}]},{"level":2,"title":"二、方案选择与硬件落地（What）","slug":"二、方案选择与硬件落地-what","link":"#二、方案选择与硬件落地-what","children":[{"level":3,"title":"1. 为什么选择旁路由方案","slug":"_1-为什么选择旁路由方案","link":"#_1-为什么选择旁路由方案","children":[]},{"level":3,"title":"2. 硬件选择：GL-MT3000","slug":"_2-硬件选择-gl-mt3000","link":"#_2-硬件选择-gl-mt3000","children":[]},{"level":3,"title":"3. 实际落地步骤概览","slug":"_3-实际落地步骤概览","link":"#_3-实际落地步骤概览","children":[]}]},{"level":2,"title":"三、旁路由部署中的关键经验（How - Part 1）","slug":"三、旁路由部署中的关键经验-how-part-1","link":"#三、旁路由部署中的关键经验-how-part-1","children":[{"level":3,"title":"1. LAN / WAN / DHCP 的关键认知","slug":"_1-lan-wan-dhcp-的关键认知","link":"#_1-lan-wan-dhcp-的关键认知","children":[]}]},{"level":2,"title":"四、代理实现方案的演进（How - Part 2）","slug":"四、代理实现方案的演进-how-part-2","link":"#四、代理实现方案的演进-how-part-2","children":[{"level":3,"title":"1. 为什么选择 redsocks","slug":"_1-为什么选择-redsocks","link":"#_1-为什么选择-redsocks","children":[]},{"level":3,"title":"2. redsocks 最小可用配置","slug":"_2-redsocks-最小可用配置","link":"#_2-redsocks-最小可用配置","children":[]}]},{"level":2,"title":"五、iptables → nftables → fw4 的真实迁移过程（How - Part 3）","slug":"五、iptables-→-nftables-→-fw4-的真实迁移过程-how-part-3","link":"#五、iptables-→-nftables-→-fw4-的真实迁移过程-how-part-3","children":[{"level":3,"title":"1. 为什么 iptables 行不通","slug":"_1-为什么-iptables-行不通","link":"#_1-为什么-iptables-行不通","children":[]},{"level":3,"title":"2. 手写 nftables 的风险","slug":"_2-手写-nftables-的风险","link":"#_2-手写-nftables-的风险","children":[]},{"level":3,"title":"3. 正确答案：fw4 + UCI","slug":"_3-正确答案-fw4-uci","link":"#_3-正确答案-fw4-uci","children":[]}]},{"level":2,"title":"六、最终正确方案（How - Part 4）","slug":"六、最终正确方案-how-part-4","link":"#六、最终正确方案-how-part-4","children":[{"level":3,"title":"1. 用 UCI 声明式创建重定向规则","slug":"_1-用-uci-声明式创建重定向规则","link":"#_1-用-uci-声明式创建重定向规则","children":[]},{"level":3,"title":"2. 数据流向图（Mermaid）","slug":"_2-数据流向图-mermaid","link":"#_2-数据流向图-mermaid","children":[]}]},{"level":2,"title":"七、验证与成功判据（How - Part 5）","slug":"七、验证与成功判据-how-part-5","link":"#七、验证与成功判据-how-part-5","children":[{"level":3,"title":"1. redsocks 是否监听","slug":"_1-redsocks-是否监听","link":"#_1-redsocks-是否监听","children":[]},{"level":3,"title":"2. fw4 规则是否正确生成","slug":"_2-fw4-规则是否正确生成","link":"#_2-fw4-规则是否正确生成","children":[]}]},{"level":2,"title":"八、常见问题与排错总结（Troubleshooting）","slug":"八、常见问题与排错总结-troubleshooting","link":"#八、常见问题与排错总结-troubleshooting","children":[{"level":3,"title":"Q1：为什么 WebUI 访问不了？","slug":"q1-为什么-webui-访问不了","link":"#q1-为什么-webui-访问不了","children":[]},{"level":3,"title":"Q2：iptables 明明装了却不能用？","slug":"q2-iptables-明明装了却不能用","link":"#q2-iptables-明明装了却不能用","children":[]},{"level":3,"title":"Q3：nftables 语法总报错？","slug":"q3-nftables-语法总报错","link":"#q3-nftables-语法总报错","children":[]},{"level":3,"title":"Q4：为什么 DNAT 报 “transport protocol mapping”？","slug":"q4-为什么-dnat-报-transport-protocol-mapping","link":"#q4-为什么-dnat-报-transport-protocol-mapping","children":[]}]},{"level":2,"title":"九、最终总结（Takeaways）","slug":"九、最终总结-takeaways","link":"#九、最终总结-takeaways","children":[]}],"git":{"createdTime":1765868546000,"updatedTime":1765868546000,"contributors":[{"name":"233Mac","username":"233Mac","email":"ayusummer233@vip.qq.com","commits":1,"url":"https://github.com/233Mac"}]},"readingTime":{"minutes":4.19,"words":1257},"filePathRelative":"DailyLife/组网/GL-MT3000刷Openwrt作为末端无线面板接入mesh组网.md","localizedDate":"2025年12月16日","excerpt":"","autoDesc":true}');export{g as comp,u as data};
