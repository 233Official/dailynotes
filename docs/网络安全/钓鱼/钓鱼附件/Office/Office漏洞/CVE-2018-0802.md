---
date: 2025-10-09
category:
  - 网络安全
  - 网络钓鱼
tags:
  - 钓鱼附件
  - Office
  - Office漏洞
  - CVE-2018-0802
excerpt: 由于内存中对象处理方式不当，Microsoft Office 2007、Microsoft Office 2010、Microsoft Office 2013 和 Microsoft Office 2016 中的公式编辑器存在远程代码执行漏洞，也称为“Microsoft Office 内存损坏漏洞”。此 CVE 与 CVE-2018-0797 和 CVE-2018-0812 不同。
---

# CVE-2018-0802

## 简介

在2017年11月14日，微软发布11月份安全补丁更新，其中更新了潜伏17年之久的Office远程代码执行漏洞(CVE-2017-11882) “噩梦公式一代“

而在2018年1月，又爆出了office 0day漏洞(CVE-2018-0802),该漏洞的技术原理类似17年修补的漏洞，是由于office公式编辑器组件EQNEDT32.EXE，对字体名的长度没有进行长度检验，导致攻击者可以通过构造恶意的字体名，在当前登录用户的上下文中执行任意代码。失败的攻击尝试可能会引发 DoS攻击 ，全部版本受影响。我们将其命名为“噩梦公式二代”（CVE-2018-0802）。

---

## 复现环境

- 靶机: 
  - [Win7SP1旗舰版](https://next.itellyou.cn/Original/#cbp=Product?ID=6f677346-0a09-43fa-b60d-e878ed7625a0)+[Office2016](https://msdn.itellyou.cn/)
  - IP: `192.168.5.11`

- 攻击机 Kali
  - IP: `100.1.1.131`

---

## 漏洞复现

利用 [GitHub - rxwx/CVE-2018-0802: PoC Exploit for CVE-2018-0802 (and optionally CVE-2017-11882)](https://github.com/rxwx/CVE-2018-0802) 中提供的弹出计算器的样本执行即可

![image-20240617073129137](http://cdn.ayusummer233.top/DailyNotes/202406170732208.png)

---


## 参考材料

- 分析
  - [“噩梦公式”二代 | 2018年微软修复的首个Office 0day漏洞（CVE-2018-0802... - FreeBuf网络安全行业门户](https://www.freebuf.com/vuls/159789.html)

  - [Microsoft Office 栈溢出漏洞 (CVE-2018-0802)分析报告 - FreeBuf网络安全行业门户](https://www.freebuf.com/articles/others-articles/241059.html)

  - [一个二进制POC的诞生之旅CVE-2018-0802-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1043723)

  - [[原创\]CVE-2018-0802个人浅析-二进制漏洞-看雪-安全社区|安全招聘|kanxue.com](https://bbs.kanxue.com/thread-253457.htm#msg_header_h1_0)

  - [手把手教你复现office公式编辑器内的第三个漏洞-安全客 - 安全资讯平台 (anquanke.com)](https://www.anquanke.com/post/id/94841)

  - [漏洞分析之CVE-2018-0802 - 记得按时恰饭 - 博客园 (cnblogs.com)](https://www.cnblogs.com/Get-Me/p/b3dac8831fa0284563d012ecdf9dbe91.html)

- 利用工具
  - [CVE-2018-0802,CVE-2018-0802 (以及可选的 CVE-2017-11882) 的 PoC 漏洞利用,下载CVE-2018-0802的源码_GitHub_帮酷 --- GitHub - rxwx/CVE-2018-0802: PoC Exploit for CVE-2018-0802 (and optionally CVE-2017-11882)](https://github.com/rxwx/CVE-2018-0802)

- 复现过程
  - msf
    - [CVE-2018-0802 office噩梦公式二代复现|棉花哥的博客|Cotton's Blog (mianhuage.com)](http://www.mianhuage.com/791.html)

    - [【漏洞复现】噩梦公式二代漏洞|EQNETD32.exe栈溢出漏洞|公式编辑器栈溢出漏洞（CVE-2018-0802）-CSDN博客](https://blog.csdn.net/Cody_Ren/article/details/103959944)

- 检测对抗